%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[a4paper,11pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Getting started}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


    \usepackage
    {charter}
    \usepackage[defaultsans]
    {lato}
    \usepackage
    {inconsolata}
    

\title{CLIMaCCF Documentation}
\date{Aug 05, 2022}
\release{V1.0}
\author{DLR, TUHH, TUD, UC3M}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Introduction}
\label{\detokenize{index:introduction}}
\sphinxAtStartPar
\sphinxstylestrong{About:} The Python Library CLIMaCCF is a software package developed by UC3M and DLR. The main idea of CLIMaCCF is to provide an open\sphinxhyphen{}source, easy\sphinxhyphen{}to\sphinxhyphen{}use, and flexible software tool that efficiently calculates the spatial and temporal resolved climate impact of aviation emissions by using algorithmic climate change functions (aCCFs). The individual aCCFs of water vapour, NOx\sphinxhyphen{}induced ozone and methane, and contrail\sphinxhyphen{}cirrus and also merged non\sphinxhyphen{}CO2 aCCFs that combine the individual aCCFs can be calculated.

\sphinxAtStartPar
\sphinxstylestrong{License:} CLIMaCCF is released under GNU General Public License Licence (Version 3). Citation of the CLIMaCCF connected software documentation paper is kindly requested upon use, with software DOI for CLIMaCCF (doi:XXX) and version number:

\sphinxAtStartPar
\sphinxstylestrong{Citation info:} Dietmüller, S. Matthes, S., Dahlmann, K., Yamashita, H., Soler, M., Simorgh, A., Linke, F., Lührs, B., Mendiguchia Meuser, M. , Weder, C., Yin, F., Castino, F., Gerwe, V. (2022): A python library for computing individual and merged non\sphinxhyphen{}CO2 algorithmic climate change functions: CLIMaCCF V1.0, Geoscientific Model Development (GMD).

\sphinxAtStartPar
\sphinxstylestrong{Support:} Support of all general technical questions on CLIMaCCF, i.e. installation, application and development will be provided by Abolfazl Simorgh (\sphinxhref{mailto:abolfazl.simorgh@uc3m.es}{abolfazl.simorgh@uc3m.es}), Simone Dietmüller (\sphinxhref{mailto:Simone.Dietmueller@dlr.de}{Simone.Dietmueller@dlr.de}), and Hiroshi Yamashita (\sphinxhref{mailto:Hiroshi.Yamashita@dlr.de}{Hiroshi.Yamashita@dlr.de}).

\sphinxAtStartPar
\sphinxstylestrong{Core developer team:} Abolfazl Simorgh (UM3M), Simone Dietmüller (DLR), Hiroshi Yamashita (DLR), Manuel Soler (UC3M), Sigrun Matthes (DLR)


\chapter{Getting started:}
\label{\detokenize{index:getting-started}}
\sphinxAtStartPar
This section briefly presents the necessary information required to get started with CLIMaCCF.

\sphinxstepscope


\section{Installation}
\label{\detokenize{gStarted:installation}}\label{\detokenize{gStarted::doc}}
\sphinxAtStartPar
The installation is the first step to working with CLIMaCCF. In the following, the steps required to install the library are provided.
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{-1}
\item {} 
\sphinxAtStartPar
it is highly recomended to create a virtual environment:

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{conda} \PYG{n}{create} \PYG{o}{\PYGZhy{}}\PYG{n}{n} \PYG{n}{env\PYGZus{}climaccf}
\PYG{n}{conda} \PYG{n}{activate} \PYG{n}{env\PYGZus{}climaccf}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Clone or download the repository.

\item {} 
\sphinxAtStartPar
Locate yourself in the CLIMaCCF (library folder) path, and run the following line, using terminal (in MacOS and Linux) or cmd (Windows), which will install all dependencies:

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{python} \PYG{n}{setup}\PYG{o}{.}\PYG{n}{py} \PYG{n}{install}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
The installation package contains a set of sample data and an example script for testing purpose. To run it, at the library folder, enter the following command:

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{python} \PYG{n}{setup}\PYG{o}{.}\PYG{n}{py} \PYG{n}{pytest}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{3}
\item {} 
\sphinxAtStartPar
The library runs successfully if env\_processed.nc is generated at the library folder/test/sample\_data/. One can visualize the file using a visualization tool.

\end{enumerate}


\section{Configuration}
\label{\detokenize{gStarted:configuration}}
\sphinxAtStartPar
The scope of CLIMaCCF is to provide individual and merged aCCFs as spatially and temporally resolved information considering meteorology from the actual synoptical situation, the aircraft type, the selected physical climate metric, and the selected version of prototype algorithms in individual aCCFs. Consequently, some user\sphinxhyphen{}preferred settings need to
be defined. Within CLIMaCCF, theses settings are defined in a dictionary, called \sphinxstyleemphasis{confg} (i.e., confg {[}‘name’{]} = value). Notice that default values for the settings have been defined within the library database; thus, defining dictionary \sphinxstyleemphasis{confg} is optional and, if included, overwrites the default ones.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{confg} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Configuration of the calculation of algorithmic climate change functions (aCCFs) \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} If true, efficacies are included}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{efficacy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{efficacy\PYGZhy{}option}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lee\PYGZus{}2021}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}lee\PYGZus{}2021\PYGZsq{} (efficacies according to Lee et al. (2021))}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZob{}\PYGZsq{}CH4\PYGZsq{}: xx, \PYGZsq{}O3\PYGZsq{}: xx, \PYGZsq{}H2O\PYGZsq{}: xx, \PYGZsq{}Cont.\PYGZsq{}: xx, \PYGZsq{}CO2\PYGZsq{}: xx\PYGZcb{} (user\PYGZhy{}defined efficacies)}

\PYG{c+c1}{\PYGZsh{} Specifies the version of the prototype aCCF}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aCCF\PYGZhy{}V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V1.1}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Currently 2 options:}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}V1.0\PYGZsq{}: Yin et al. (2022)}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZsq{}V1.1\PYGZsq{}: Matthes et al. (2022)}

\PYG{c+c1}{\PYGZsh{} User\PYGZhy{}defined scaling factors of the above selected aCCF version. Not recommented to be changed from default value (i.e., 1), unless modification of the aCCFs is wanted (e.g. sensitivity studies)}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aCCF\PYGZhy{}scalingF}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CH4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{H2O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Cont.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Specifies the emission scenario of the climate metric. Currently, pulse emission and increasing future emission scenario (business as usual) included}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{emission\PYGZus{}scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{future\PYGZus{}scenario}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Currently 2 options:}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}pulse\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZsq{}future\PYGZus{}scenario\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Specifies the climate indicator. Currently, Average Temperature Response (ATR) has been implemented}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{climate\PYGZus{}indicator}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ATR}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Currently 1 option: \PYGZsq{}ATR\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Specifies the time horizon (in years) over which the selected climate indicator is calculated}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TimeHorizon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{c+c1}{\PYGZsh{} Option one: 20}
\PYG{c+c1}{\PYGZsh{} Option two: 50}
\PYG{c+c1}{\PYGZsh{} Option three: 100}

\PYG{c+c1}{\PYGZsh{} Determination of persistent contrail formation areas (PCFA), needed to calculate aCCF of (day/night) contrails.}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PCFA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{PCFA}\PYG{o}{\PYGZhy{}}\PYG{n}{ISSR}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}PCFA\PYGZhy{}ISSR\PYGZsq{} (PCFA defined by ice\PYGZhy{}supersaturated regions with threshold for relative humidity over ice and temperature)}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZsq{}PCFA\PYGZhy{}SAC\PYGZsq{} (Contrail formation with Schmidt\PYGZhy{}Appleman criterion SAC (Appleman, 1953) \PYGZam{} contrail persistence, if ambient air is ice supersaturated)}

\PYG{c+c1}{\PYGZsh{} Parameters for calculating ice\PYGZhy{}supersaturated regions (ISSR). \PYGZsq{}rhi\PYGZus{}threshold\PYGZsq{} specifies the threshold of relative humidity over ice in order to identify ice supersaturated regions. Note that for persistent contrails relative humidity over ice has to be greater 100\PYGZpc{}. However to take into account subgridscale variability in humidity field of input data, the threshold of relative humidity (over ice) has to be adopted for the selected resolution of data product (for more details see Dietmueller et al. 2022)}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ISSR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=}  \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rhi\PYGZus{}threshold}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.95}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{temp\PYGZus{}threshold}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{235}\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} Options for \PYGZsq{}rhi\PYGZus{}threshold\PYGZsq{}: user defined threshold value \PYGZlt{} 1. Threshold depends on the used data set, e.g.,in case of the reanalysis data product ERA5 with high resolution (HRES) it is 0.9}

\PYG{c+c1}{\PYGZsh{} Parameters for calculating Schmidt\PYGZhy{}Appleman criterion (SAC). These parameters vary for different aircraft types.}
\PYG{n}{confg} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SAC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Q}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{43} \PYG{o}{*} \PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{eta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.3}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{EI\PYGZus{}H2O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.25}\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} \PYGZsq{}EI\PYGZus{}H2O\PYGZsq{}: water vapour emission\PYGZsq{}s index in [kg(H2O)/kg(fuel)]}
\PYG{c+c1}{\PYGZsh{} \PYGZsq{}Q\PYGZsq{}: Fuel specific energy in [J/kg]}
\PYG{c+c1}{\PYGZsh{} \PYGZsq{}eta\PYGZsq{}: Engine’s overall efficiency}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Technical specifiactions of aircraft/engine dependent parameters \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Specifies the values of NOx emission index (NOx\PYGZus{}EI) and flown distance per kg burnt fuel (F\PYGZus{}km)}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NOx\PYGZus{}EI\PYGZam{}F\PYGZus{}km}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TTV}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}TTV\PYGZsq{} for typical transantlantic fleet mean values (NOx\PYGZus{}EI, F\PYGZus{}km) from literature (Penner et al. 1999, Graver and Rutherford 2018)}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZsq{}ac\PYGZus{}dependent\PYGZsq{} for altitude and aircraft/engine dependent values (NOx\PYGZus{}EI, F\PYGZus{}km).}
\PYG{c+c1}{\PYGZsh{} Note that \PYGZdq{}If Confg[\PYGZsq{}NOx\PYGZus{}EI\PYGZam{}F\PYGZus{}km\PYGZsq{}] = \PYGZsq{}TTV\PYGZsq{}, the following confg[\PYGZsq{}ac\PYGZus{}type\PYGZsq{}] is ignored.}

\PYG{c+c1}{\PYGZsh{} If Confg[\PYGZsq{}NOx\PYGZus{}EI\PYGZam{}F\PYGZus{}km\PYGZsq{}] = \PYGZsq{}ac\PYGZus{}dependent\PYGZsq{}, aircraft class (i.e. regional, single\PYGZhy{}aisle, wide\PYGZhy{}body) needs to be selected. For these aircraft classes aggregated fleet\PYGZhy{}level values of NOx\PYGZus{}EI and F\PYGZus{}km are provided (for more details see Dietmueller et al. 2022).}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ac\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wide\PYGZhy{}body}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}regional\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZsq{}single\PYGZhy{}aisle\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option three: \PYGZsq{}wide\PYGZhy{}body\PYGZsq{}}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Specifies the saved output file \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} If true, the primary mode ozone (PMO) effect is included to the CH4 aCCF and the total NOx aCCF}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PMO}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, the total NOx aCCF is calculated (i.e. aCCF\PYGZhy{}NOx = aCCF\PYGZhy{}CH4 + aCCF\PYGZhy{}O3)}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NOx\PYGZus{}aCCF}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, all individual aCCFs are converted to the same unit of K/kg(fuel) and saved in the output file.}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{unit\PYGZus{}K/kg(fuel)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, merged non\PYGZhy{}CO2 aCCF is calculated}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{merged}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, climate hotspots (regions that are very senitive to aviation emissisions) are calculated (for more details see Dietmueller et al. 2022)}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Chotspots}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If constant, climate hotspots are calculated based on the user\PYGZhy{}specified threshold, if dynamic, the thresholds for identifying climate hotspots are determined dynamically by calculating the percentile value of the merged aCCF over a certain geographical region (for details, see Dietmueller et al. 2022).}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Chotspots\PYGZus{}calc\PYGZus{}method}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dynamic}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option one: \PYGZsq{}constant\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Option two: \PYGZsq{}dynamic\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Specifies the constant threshold for calculating climate hotspots (if Chotspots\PYGZus{}calc\PYGZus{}method: constant)}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Chotspots\PYGZus{}calc\PYGZus{}method\PYGZus{}cons}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}13}

\PYG{c+c1}{\PYGZsh{} Specifies the percentage (e.g. 95\PYGZpc{}) of the percentile value as well as the geographical region for which the percentile of the merged aCCF is calculated. Thus the percentile defines the dynamical threshold for climate hotspots (if Chotspots\PYGZus{}calc\PYGZus{}method: dynamic). Note that percentiles are saved in the output file}
\PYG{n}{confg} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Chotspots\PYGZus{}calc\PYGZus{}method\PYGZus{}dynm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hotspots\PYGZus{}percentile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{95}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{latitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{False}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{longitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{False}\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} Options for \PYGZsq{}hotspots\PYGZus{}percentile\PYGZsq{}: percentage \PYGZlt{} 100}
\PYG{c+c1}{\PYGZsh{} Options for \PYGZsq{}latitude\PYGZsq{}: (lat\PYGZus{}min, lat\PYGZus{}max), False}
\PYG{c+c1}{\PYGZsh{} Options for \PYGZsq{}longitude\PYGZsq{}: (lon\PYGZus{}min, lon\PYGZus{}max), False}

\PYG{c+c1}{\PYGZsh{} If true, it assigns binary values to climate hotspots (0: areas with climate impacts below a specified threshold. 1: areas with climate impacts above a specified threshold). If false, it assigns 0 for areas with climate impacts below the specified threshold and provides values of merged aCCFs for areas with climate impacts above the threshold.}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hotspots\PYGZus{}binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, meteorological input variables, needed to calculate aCCFs, are saved in the netCDF output file in same resolution as the aCCFs}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MET\PYGZus{}variables}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, polygons containing climate hotspots will be saved in the GeoJson file}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{geojson}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} Specifies the color of polygons}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{color}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{copper}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{} Options: colors of cmap, e.g., copper, jet, Reds}

\PYG{c+c1}{\PYGZsh{} Specifies the horizontal resolution}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{horizontal\PYGZus{}resolution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=}  \PYG{l+m+mf}{0.5}
\PYG{c+c1}{\PYGZsh{} Options: lower resolutions in degrees}

\PYG{c+c1}{\PYGZsh{} Specifies geographical region}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat\PYGZus{}bound}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: (lat\PYGZus{}min, lat\PYGZus{}max), False}

\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon\PYGZus{}bound}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: (lon\PYGZus{}min, lon\PYGZus{}max), False}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Specifies output for statistical analysis, if ensemble prediction system (EPS) data products are used \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} The following two options (confg[\PYGZsq{}mean\PYGZsq{}], confg[\PYGZsq{}std\PYGZsq{}]) are ignored if the input data are deterministic}

\PYG{c+c1}{\PYGZsh{} If true, mean values of aCCFs and variables are saved in the netCDF output file}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}

\PYG{c+c1}{\PYGZsh{} If true, standard deviation of aCCFs and variables are saved in the netCDF output file}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{std}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{c+c1}{\PYGZsh{} Options: True, False}
\end{sphinxVerbatim}

\sphinxAtStartPar
Another alternative is to include these settings in the separate configuration file and then load them within the main script.
In the directory of CLIMaCCF, one can find a sample configuration file, including the mentioned configurations in the YAML file (i.e., config\sphinxhyphen{}user.yml). In this case, one can load the configurations in the main script using

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{config\PYGZhy{}user.yml}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{ymlfile}\PYG{p}{:} \PYG{n}{confg} \PYG{o}{=} \PYG{n}{yaml}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{ymlfile}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Input}
\label{\detokenize{gStarted:input}}
\sphinxAtStartPar
To calculate aCCFs, some meteorological variables are required. CLIMaCCF takes these variables as input (See Table 5 of the connected paper (i.e., Dietmüller et al. (2022)).
These variables are Temperature, Geopotential height, Relative humidity over ice, and Potential vorticity at different pressure levels,
and outgoing longwave radiation (or top net thermal radiation) and incoming solar radiation at the top of the atmosphere (TOA).
The current implementation of the Library is compatible with the standard of the European Centre for Medium\sphinxhyphen{}Range Weather Forecasts (ECMWF) data (for both reanalysis and forecast data products).
The user should provide two datasets, separating data provided at each pressure level and surface variables, typically collected in different datasets. Within CLIMaCCF, the directories of these two datasets are to be defined as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{input\PYGZus{}dir} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} Input data provided at pressure levels such as temperature, geopotential and relative humidity:}
\PYG{n}{input\PYGZus{}dir}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path\PYGZus{}pl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}  \PYG{o}{=} \PYG{n}{dir\PYGZus{}pressure\PYGZus{}variables}

\PYG{c+c1}{\PYGZsh{} Input data provided in single pressure level such as top net thermal radiation at the TOA:}
\PYG{n}{input\PYGZus{}dir}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path\PYGZus{}sur}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=}  \PYG{n}{dir\PYGZus{}surface\PYGZus{}variables}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxthecaptionisattop
\sphinxcaption{Main input prameters required for CLIMaCCF.}\label{\detokenize{gStarted:id1}}
\sphinxaftertopcaption
\begin{tabular}[t]{|\X{30}{75}|\X{15}{75}|\X{15}{75}|\X{15}{75}|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Parameter}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Short name}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{Units}
&\sphinxstyletheadfamily 
\sphinxAtStartPar
\sphinxstylestrong{ID}
\\
\hline
\sphinxAtStartPar
Pressure
&
\sphinxAtStartPar
pres
&
\sphinxAtStartPar
\([K.m^{2}/Kg.s]\)
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db/?id=54}{54}
\\
\hline
\sphinxAtStartPar
Potential vorticity
&
\sphinxAtStartPar
pv
&
\sphinxAtStartPar
\([K.m^{2}/Kg.s]\)
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db?id=60}{60}
\\
\hline
\sphinxAtStartPar
Geopotential
&
\sphinxAtStartPar
z
&
\sphinxAtStartPar
\([m^{2}/s^{2}]\)
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db/?id=129}{129}
\\
\hline
\sphinxAtStartPar
Temperature
&
\sphinxAtStartPar
t
&
\sphinxAtStartPar
\([K]\)
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db/?id=130}{130}
\\
\hline
\sphinxAtStartPar
Relative Humidity
&
\sphinxAtStartPar
r
&
\sphinxAtStartPar
{[}\%{]}
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db?id=157}{157}
\\
\hline
\sphinxAtStartPar
Top Net Thermal Radiation
&
\sphinxAtStartPar
ttr
&
\sphinxAtStartPar
\([J/m^{2}]\)
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db?id=179}{179}
\\
\hline
\sphinxAtStartPar
TOA Incident Solar Radiation
&
\sphinxAtStartPar
tisr
&
\sphinxAtStartPar
\([J/m^{2}]\)
&
\sphinxAtStartPar
\sphinxhref{https://apps.ecmwf.int/codes/grib/param-db/?id=212}{212}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
In addition to the locations of input data, the directory of the CLIMaCCF needs to be specified within input\_dir:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Directory of CLIMaCCF:}
\PYG{n}{input\PYGZus{}dir} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path\PYGZus{}lib}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{climaccf\PYGZus{}dir}
\end{sphinxVerbatim}

\sphinxAtStartPar
Finally, the directory where all outputs will be written is to be inputted by the user:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Destination directory where all output will be written:}
\PYG{n}{output\PYGZus{}dir} \PYG{o}{=} \PYG{n}{dir\PYGZus{}results}
\end{sphinxVerbatim}


\section{Running \& Output}
\label{\detokenize{gStarted:running-output}}
\sphinxAtStartPar
After defining configurations and inputting required directories, CLIMaCCF is ready to generate outputs. First of all, we import the library:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{climaccf}
\PYG{k+kn}{from} \PYG{n+nn}{climaccf}\PYG{n+nn}{.}\PYG{n+nn}{main\PYGZus{}processing} \PYG{k+kn}{import} \PYG{n}{ClimateImpact}
\end{sphinxVerbatim}

\sphinxAtStartPar
Then, the inputted variables will be processed by using the following function. The processing in this step is mainly related to 1) extracting variables within inputted data, 2) calculating required variables from alternative ones in case of missing some variables (see Table 5 of the connected paper), 3) unifying the naming and dimension of variables, and 4) changing the resolution and geographical area.
User\sphinxhyphen{}preferred processings such as horizontal resolution and geographical area extracted from \sphinxstyleemphasis{confg}. Notice that the horizontal resolution cannot be higher than the resolution of the inputted meteorological data. In addition, inputting \sphinxstyleemphasis{confg} is optional and will rewrite the default settings if inputted.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{CI} \PYG{o}{=} \PYG{n}{ClimateImpact}\PYG{p}{(}\PYG{n}{input\PYGZus{}dir}\PYG{p}{,} \PYG{n}{output\PYGZus{}dir}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{confg}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
After processing the weather data, aCCFs are calculated using the following command with respect to the defined settings in the dictionary (i.e., \sphinxstyleemphasis{confg}) and saved within the netCDF file format in the specified directory.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{CI}\PYG{o}{.}\PYG{n}{calculate\PYGZus{}accfs}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{confg}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Following the previous steps, an output file (in netCDF format) will be generated. The output file contains different variables depending on the selected configurations (in \sphinxstyleemphasis{confg}).
For instance, the output file contains both individual and merged aCCFs  if confg {[}‘merged’{]} = True and the inputted metrological parameters if confg {[}‘MET\_variables’{]} = True. The dimension of outputted variables for the Ensemble prediction system (EPS) data products is (time, member, pressure level, latitude, longitude), and for the deterministic ones is (time, pressure level, latitude, longitude).
The generated netCDF file is compatible with well\sphinxhyphen{}known visualization tools such as ferret, NCO, and Panoply.
In addition to the netCDF file, if one selects: confg{[}‘geojson’{]} = True, confg{[}Chotspots{]} = True, some GeoJson files (number: pressure levels * number of time) will be generated in the specified output directory.


\chapter{Modules:}
\label{\detokenize{index:modules}}
\sphinxstepscope


\section{Processing of meteorological input data}
\label{\detokenize{modules:module-climaccf.extract_data}}\label{\detokenize{modules:processing-of-meteorological-input-data}}\label{\detokenize{modules::doc}}\index{module@\spxentry{module}!climaccf.extract\_data@\spxentry{climaccf.extract\_data}}\index{climaccf.extract\_data@\spxentry{climaccf.extract\_data}!module@\spxentry{module}}\index{extract\_coordinates() (in module climaccf.extract\_data)@\spxentry{extract\_coordinates()}\spxextra{in module climaccf.extract\_data}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.extract_data.extract_coordinates}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.extract\_data.}}\sphinxbfcode{\sphinxupquote{extract\_coordinates}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{ex\_variables}}, \emph{\DUrole{n}{ds\_sur}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Extracts coordinates (axes) in the inputted dataset defined with different possible names.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\sphinxlineitem{Returns ex\_var\_name}
\sphinxAtStartPar
List of available coordinates.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\sphinxlineitem{Returns variables}
\sphinxAtStartPar
Assigns bool to the axes (e.g., if ensemble members are not available, it sets False).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{extract\_data\_variables() (in module climaccf.extract\_data)@\spxentry{extract\_data\_variables()}\spxextra{in module climaccf.extract\_data}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.extract_data.extract_data_variables}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.extract\_data.}}\sphinxbfcode{\sphinxupquote{extract\_data\_variables}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{ds\_sr}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Extracts available required variables in the inputted dataset defined with different possible names.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds\_sr}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Used to show more information.

\end{itemize}

\sphinxlineitem{Returns ex\_var\_name}
\sphinxAtStartPar
Available required weather variables.

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\sphinxlineitem{Returns variables}
\sphinxAtStartPar
Assigns bool to the required wethear variables.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{logic\_cal\_accfs() (in module climaccf.extract\_data)@\spxentry{logic\_cal\_accfs()}\spxextra{in module climaccf.extract\_data}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.extract_data.logic_cal_accfs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.extract\_data.}}\sphinxbfcode{\sphinxupquote{logic\_cal\_accfs}}}{\emph{\DUrole{n}{variables}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Creates a dictionary containing logical values showing the possibility to calculate each aCCF.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Variables available in the given dataset.

\sphinxlineitem{Returns}
\sphinxAtStartPar
dictionary containing logical values showing the possibility to calculate each aCCF.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\phantomsection\label{\detokenize{modules:module-climaccf.extend_dim}}\index{module@\spxentry{module}!climaccf.extend\_dim@\spxentry{climaccf.extend\_dim}}\index{climaccf.extend\_dim@\spxentry{climaccf.extend\_dim}!module@\spxentry{module}}\index{extend\_dimensions() (in module climaccf.extend\_dim)@\spxentry{extend\_dimensions()}\spxextra{in module climaccf.extend\_dim}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.extend_dim.extend_dimensions}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.extend\_dim.}}\sphinxbfcode{\sphinxupquote{extend\_dimensions}}}{\emph{\DUrole{n}{inf\_coord}}, \emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{ds\_sur}}, \emph{\DUrole{n}{ex\_variables}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Unifies the dimension of all types of given data as either 4\sphinxhyphen{}dimensional or 5\sphinxhyphen{}dimensional arrays, depending on
the existence of ensemble members. If the data has only two fields: latitude and longitude, this function
adds time and level fields, (e.g., for the deterministic data products: (latitude:360, longitude:720) \sphinxhyphen{}\textgreater{} (time:1, pressure level:1, latitude:360, longitude:720)).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{inf\_coord}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Information on original coordinates.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray containing variables on pressure levels.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds\_sur}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ex\_variables}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} New coordinates

\end{itemize}

\sphinxlineitem{Returns ds\_pl}
\sphinxAtStartPar
New dataset of pressure level variables including the added coordinates

\sphinxlineitem{Return type}
\sphinxAtStartPar
dataset

\sphinxlineitem{Returns ds\_surf}
\sphinxAtStartPar
New dataset of surface parameters including the added coordinates

\sphinxlineitem{Return type}
\sphinxAtStartPar
dataset

\end{description}\end{quote}

\end{fulllineitems}

\phantomsection\label{\detokenize{modules:module-climaccf.processing_surf_vars}}\index{module@\spxentry{module}!climaccf.processing\_surf\_vars@\spxentry{climaccf.processing\_surf\_vars}}\index{climaccf.processing\_surf\_vars@\spxentry{climaccf.processing\_surf\_vars}!module@\spxentry{module}}\index{extend\_olr\_pl\_4d() (in module climaccf.processing\_surf\_vars)@\spxentry{extend\_olr\_pl\_4d()}\spxextra{in module climaccf.processing\_surf\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.processing_surf_vars.extend_olr_pl_4d}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.processing\_surf\_vars.}}\sphinxbfcode{\sphinxupquote{extend\_olr\_pl\_4d}}}{\emph{\DUrole{n}{sur\_var}}, \emph{\DUrole{n}{pl\_var}}, \emph{\DUrole{n}{index}}, \emph{\DUrole{n}{fore\_step}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates outgoing longwave radiation (OLR) {[}W/m2{]} at TOA from the parameter top net thermal radiation (ttr)
{[}J/m2{]}, and extends (duplicating) it to all pressure levels for consistency of dimensions. For a specific time, OLR is calculated in 3D (i.e., level, latitude, longitude).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sur\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pl\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing pressure level parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Index of the time.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fore\_step}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Forecast step in hours.

\end{itemize}

\sphinxlineitem{Returns arr}
\sphinxAtStartPar
OLR in 3D (i.e., level, latitude, longitude).

\sphinxlineitem{Return type}
\sphinxAtStartPar
array

\end{description}\end{quote}

\end{fulllineitems}

\index{extend\_olr\_pl\_5d() (in module climaccf.processing\_surf\_vars)@\spxentry{extend\_olr\_pl\_5d()}\spxextra{in module climaccf.processing\_surf\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.processing_surf_vars.extend_olr_pl_5d}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.processing\_surf\_vars.}}\sphinxbfcode{\sphinxupquote{extend\_olr\_pl\_5d}}}{\emph{\DUrole{n}{sur\_var}}, \emph{\DUrole{n}{pl\_var}}, \emph{\DUrole{n}{index}}, \emph{\DUrole{n}{fore\_step}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates outgoing longwave radiation (OLR) {[}W/m2{]} at TOA from the parameter top net thermal radiation (ttr)
{[}J/m2{]}, and extends (duplicating) it to all pressure levels for consistency of dimensions. For a specific time, OLR is calculated in 4D (i.e., number, level, latitude, longitude).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sur\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pl\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing pressure level parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Index of the time that exists in the dataset of pressure level parameters at this step.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fore\_step}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Forecast step in hours.

\end{itemize}

\sphinxlineitem{Returns arr}
\sphinxAtStartPar
OLR in 4D (i.e., number, level, latitude, longitude).

\sphinxlineitem{Return type}
\sphinxAtStartPar
array

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_olr() (in module climaccf.processing\_surf\_vars)@\spxentry{get\_olr()}\spxextra{in module climaccf.processing\_surf\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.processing_surf_vars.get_olr}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.processing\_surf\_vars.}}\sphinxbfcode{\sphinxupquote{get\_olr}}}{\emph{\DUrole{n}{sur\_var}}, \emph{\DUrole{n}{pl\_var}}, \emph{\DUrole{n}{number}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{fore\_step}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates outgoing longwave radiation (OLR) {[}W/m2{]} at TOA from the parameter top net thermal radiation (ttr)
{[}J/m2{]}. OLR is calculated in 5D or 4D depending on the existance of ensemble members.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sur\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pl\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Dataset containing pressure level parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{number}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Determines whether the weather data contains ensemble members or not.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fore\_step}} \textendash{} Forecast step in hours.

\end{itemize}

\sphinxlineitem{Returns arr}
\sphinxAtStartPar
OLR.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_olr\_4d() (in module climaccf.processing\_surf\_vars)@\spxentry{get\_olr\_4d()}\spxextra{in module climaccf.processing\_surf\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.processing_surf_vars.get_olr_4d}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.processing\_surf\_vars.}}\sphinxbfcode{\sphinxupquote{get\_olr\_4d}}}{\emph{\DUrole{n}{sur\_var}}, \emph{\DUrole{n}{pl\_var}}, \emph{\DUrole{n}{thr}}, \emph{\DUrole{n}{fore\_step}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates outgoing longwave radiation (OLR) {[}W/m2{]} at TOA from the parameter top net thermal radiation (ttr)
{[}J/m2{]}. OLR is calculated in 4D (i.e, time, level, latitude, longitude).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sur\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pl\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Dataset containing pressure level parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{thr}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Thresholds to automatically determine forecast steps.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fore\_step}} \textendash{} Forecast step in hours.

\end{itemize}

\sphinxlineitem{Returns arr}
\sphinxAtStartPar
OLR in 4D (i.e., time, level, latitude, longitude).

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_olr\_5d() (in module climaccf.processing\_surf\_vars)@\spxentry{get\_olr\_5d()}\spxextra{in module climaccf.processing\_surf\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.processing_surf_vars.get_olr_5d}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.processing\_surf\_vars.}}\sphinxbfcode{\sphinxupquote{get\_olr\_5d}}}{\emph{\DUrole{n}{sur\_var}}, \emph{\DUrole{n}{pl\_var}}, \emph{\DUrole{n}{thr}}, \emph{\DUrole{n}{fore\_step}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates outgoing longwave radiation (OLR) {[}W/m2{]} at TOA from the parameter top net thermal radiation (ttr)
{[}J/m2{]}. OLR is calculated in 5D (i.e, time, number, level, latitude, longitude).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sur\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset containing surface parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pl\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Dataset containing pressure level parameters openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{thr}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Thresholds to automatically determine forecast steps.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fore\_step}} \textendash{} Forecast step in hours.

\end{itemize}

\sphinxlineitem{Returns arr}
\sphinxAtStartPar
OLR in 5D (i.e., time, number, level, latitude, longitude).

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}



\section{Calculation of meteorological input data from alternative variables}
\label{\detokenize{modules:module-climaccf.calc_altrv_vars}}\label{\detokenize{modules:calculation-of-meteorological-input-data-from-alternative-variables}}\index{module@\spxentry{module}!climaccf.calc\_altrv\_vars@\spxentry{climaccf.calc\_altrv\_vars}}\index{climaccf.calc\_altrv\_vars@\spxentry{climaccf.calc\_altrv\_vars}!module@\spxentry{module}}\index{get\_pvu() (in module climaccf.calc\_altrv\_vars)@\spxentry{get\_pvu()}\spxextra{in module climaccf.calc\_altrv\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.calc_altrv_vars.get_pvu}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.calc\_altrv\_vars.}}\sphinxbfcode{\sphinxupquote{get\_pvu}}}{\emph{\DUrole{n}{ds}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Caclulates potential vorticity {[}in PVU{]} from meteorological variables pressure, temperature and x and y component of the wind using MetPy (\sphinxurl{https://www.unidata.ucar.edu/software/metpy/}).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\sphinxlineitem{Returns PVU}
\sphinxAtStartPar
potential vorticity {[}in PVU{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_rh\_ice() (in module climaccf.calc\_altrv\_vars)@\spxentry{get\_rh\_ice()}\spxextra{in module climaccf.calc\_altrv\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.calc_altrv_vars.get_rh_ice}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.calc\_altrv\_vars.}}\sphinxbfcode{\sphinxupquote{get\_rh\_ice}}}{\emph{\DUrole{n}{ds}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates relative humidity over ice from realtive humidity over water
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\sphinxlineitem{Returns rh\_ice}
\sphinxAtStartPar
relative humidity over ice {[}in \%{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_rh\_sd() (in module climaccf.calc\_altrv\_vars)@\spxentry{get\_rh\_sd()}\spxextra{in module climaccf.calc\_altrv\_vars}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.calc_altrv_vars.get_rh_sd}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.calc\_altrv\_vars.}}\sphinxbfcode{\sphinxupquote{get\_rh\_sd}}}{\emph{\DUrole{n}{ds}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the relative humidity over ice/water from specific humidity
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\sphinxlineitem{Returns rh\_sd}
\sphinxAtStartPar
relative humidity over water/ice {[}\%{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}



\section{Weather Store}
\label{\detokenize{modules:weather-store}}\index{WeatherStore (class in climaccf.weather\_store)@\spxentry{WeatherStore}\spxextra{class in climaccf.weather\_store}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.weather_store.WeatherStore}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{climaccf.weather\_store.}}\sphinxbfcode{\sphinxupquote{WeatherStore}}}{\emph{\DUrole{n}{weather\_data}}, \emph{\DUrole{n}{weather\_data\_sur}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{flipud}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}auto\textquotesingle{}}}, \emph{\DUrole{o}{**}\DUrole{n}{weather\_config}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Prepare the data required to calculate aCCFs and store them in a xarray dataset.
\index{\_\_init\_\_() (climaccf.weather\_store.WeatherStore method)@\spxentry{\_\_init\_\_()}\spxextra{climaccf.weather\_store.WeatherStore method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.weather_store.WeatherStore.__init__}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_init\_\_}}}{\emph{\DUrole{n}{weather\_data}}, \emph{\DUrole{n}{weather\_data\_sur}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{flipud}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}auto\textquotesingle{}}}, \emph{\DUrole{o}{**}\DUrole{n}{weather\_config}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Processes the weather data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{weather\_data}} \textendash{} Dataset openned with xarray containing variables on different pressure levels.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{weather\_data\_sur}} \textendash{} Dataset openned with xarray containing variables on single pressure level (i.e., outgoing longwave radiation in this case).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_xarray() (climaccf.weather\_store.WeatherStore method)@\spxentry{get\_xarray()}\spxextra{climaccf.weather\_store.WeatherStore method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.weather_store.WeatherStore.get_xarray}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_xarray}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Creates a new xarray dataset containing processed weather variables.
\begin{quote}\begin{description}
\sphinxlineitem{Returns ds}
\sphinxAtStartPar
xarray dataset containing user\sphinxhyphen{}selected variables (e.g., merged aCCFs, mean aCCFs, Climate hotspots).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dataset

\end{description}\end{quote}

\end{fulllineitems}

\index{reduce\_domain() (climaccf.weather\_store.WeatherStore method)@\spxentry{reduce\_domain()}\spxextra{climaccf.weather\_store.WeatherStore method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.weather_store.WeatherStore.reduce_domain}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{reduce\_domain}}}{\emph{\DUrole{n}{bounds}}, \emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Reduces horizontal domain and time.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{bounds}} \textendash{} ranges defined as tuple (e.g., lat\_bound=(35, 60.0)).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\phantomsection\label{\detokenize{modules:module-climaccf.weather_store}}\index{module@\spxentry{module}!climaccf.weather\_store@\spxentry{climaccf.weather\_store}}\index{climaccf.weather\_store@\spxentry{climaccf.weather\_store}!module@\spxentry{module}}

\section{Persistent Contrail Formation}
\label{\detokenize{modules:module-climaccf.contrail}}\label{\detokenize{modules:persistent-contrail-formation}}\index{module@\spxentry{module}!climaccf.contrail@\spxentry{climaccf.contrail}}\index{climaccf.contrail@\spxentry{climaccf.contrail}!module@\spxentry{module}}\index{get\_cont\_form\_thr() (in module climaccf.contrail)@\spxentry{get\_cont\_form\_thr()}\spxextra{in module climaccf.contrail}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.contrail.get_cont_form_thr}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.contrail.}}\sphinxbfcode{\sphinxupquote{get\_cont\_form\_thr}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{member}}, \emph{\DUrole{n}{SAC\_config}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the threshold temperature and threshold of relative humidity over water required for contrail formation (Schmidt\sphinxhyphen{}Applemann\sphinxhyphen{}Citerion, Applemann 1953). A good approximation of the Schmidt\sphinxhyphen{}Appleman Criterion is given in Schumann 1996.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{member}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Detemines the presense of ensemble forecasts in the given dataset.

\end{itemize}

\sphinxlineitem{Returns SAC\_config}
\sphinxAtStartPar
Configurations containing required parameters to calculate Schmidt\sphinxhyphen{}Applemann\sphinxhyphen{}Citerion.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\sphinxlineitem{Returns T\_Crit}
\sphinxAtStartPar
Threshold temperature for Schmidt\sphinxhyphen{}Appleman

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_pcfa() (in module climaccf.contrail)@\spxentry{get\_pcfa()}\spxextra{in module climaccf.contrail}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.contrail.get_pcfa}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.contrail.}}\sphinxbfcode{\sphinxupquote{get\_pcfa}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{member}}, \emph{\DUrole{n}{confg}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the presistent contrail formation areas (PCFA) with two options: 1) PCFA defined by ice\sphinxhyphen{}supersaturated regions with threshold for relative humidity over ice and temperature and 2) Contrail formation with Schmidt\sphinxhyphen{}Appleman criterion SAC (Appleman, 1953) \& contrail persistence, if ambient air is ice supersaturated. Areas of presistent contrail formation are needed to calculate aCCF of (day/night) contrails.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{member}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Detemines the presense of ensemble members in the given dataset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{confg}} \textendash{} Configurations containing the selected option to calculate PCFA and required parameters for each option.

\end{itemize}

\sphinxlineitem{Returns pcfa}
\sphinxAtStartPar
Presistent contrail formation areas (PCFA).

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_relative\_hum() (in module climaccf.contrail)@\spxentry{get\_relative\_hum()}\spxextra{in module climaccf.contrail}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.contrail.get_relative_hum}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.contrail.}}\sphinxbfcode{\sphinxupquote{get\_relative\_hum}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{member}}, \emph{\DUrole{n}{intrp}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Relative humiditiy over ice and water provided by ECMWF dataset. In ECMWF relative humidity is defined with respect 
to saturation of the mixed phase: i.e. with respect to saturation over ice below \sphinxhyphen{}23C and with respect to saturation over water above 0C. 
In the regime in between a quadratic interpolation is applied.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{member}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Detemines the presense of ensemble forecasts in the given dataset.

\end{itemize}

\sphinxlineitem{Returns ri}
\sphinxAtStartPar
Relative humidity over ice.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\sphinxlineitem{Returns rw}
\sphinxAtStartPar
Relative humidity over water.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_rw\_from\_specific\_hum() (in module climaccf.contrail)@\spxentry{get\_rw\_from\_specific\_hum()}\spxextra{in module climaccf.contrail}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.contrail.get_rw_from_specific_hum}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.contrail.}}\sphinxbfcode{\sphinxupquote{get\_rw\_from\_specific\_hum}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{member}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates relative humidity over water from specific humidity.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dataset}}) \textendash{} Dataset openned with xarray.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{member}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Detemines the presense of ensemble forecasts in the given dataset.

\end{itemize}

\sphinxlineitem{Returns r\_w}
\sphinxAtStartPar
Relative humidity over water.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}



\section{Calculation of prototype aCCFs}
\label{\detokenize{modules:calculation-of-prototype-accfs}}\index{GeTaCCFs (class in climaccf.accf)@\spxentry{GeTaCCFs}\spxextra{class in climaccf.accf}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{climaccf.accf.}}\sphinxbfcode{\sphinxupquote{GeTaCCFs}}}{\emph{\DUrole{n}{wd\_inf}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculation of algorithmic climate change functions (aCCFs).
\index{\_\_init\_\_() (climaccf.accf.GeTaCCFs method)@\spxentry{\_\_init\_\_()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.__init__}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_init\_\_}}}{\emph{\DUrole{n}{wd\_inf}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Prepares the data required to calculate aCCFs and store them in self.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wd\_inf}} (\sphinxstyleliteralemphasis{\sphinxupquote{Class}}) \textendash{} Contains processed weather data with all information.

\end{description}\end{quote}

\end{fulllineitems}

\index{accf\_ch4() (climaccf.accf.GeTaCCFs method)@\spxentry{accf\_ch4()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.accf_ch4}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{accf\_ch4}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the aCCF of methane according to Yin et al. 2022 (aCCF\sphinxhyphen{}V1.0) and Matthes et al. 2022 (aCCF\sphinxhyphen{}V1.1): aCCF values are  given in average 
temperature response as over next 20 years, assuming pulse emission (P\sphinxhyphen{}ATR20\sphinxhyphen{}methane {[}K/kg(NO2){]}). To calculate the aCCF of methane, meteorological
variables geopotential and incoming solar radiation are required.
\begin{quote}\begin{description}
\sphinxlineitem{Returns accf}
\sphinxAtStartPar
Algorithmic climate change function of methane.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{accf\_dcontrail() (climaccf.accf.GeTaCCFs method)@\spxentry{accf\_dcontrail()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.accf_dcontrail}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{accf\_dcontrail}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the aCCF of day\sphinxhyphen{}time contrails according to Yin et al. 2022 (aCCF\sphinxhyphen{}V1.0) and Matthes et al. 2022 (aCCF\sphinxhyphen{}V1.1): aCCF values are  given in average 
temperature response as over next 20 years, assuming pulse emissions (P\sphinxhyphen{}ATR20\sphinxhyphen{}contrails {[}K/km{]}). To calculate the aCCF of day\sphinxhyphen{}time contrails,
meteorological variables temperature and relative humidity over ice are required. Notice that,
relative humidity over ice is required for the detemiation of presistent contrail formation areas.
\begin{quote}\begin{description}
\sphinxlineitem{Returns accf}
\sphinxAtStartPar
Algorithmic climate change function of day\sphinxhyphen{}time contrails.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{accf\_h2o() (climaccf.accf.GeTaCCFs method)@\spxentry{accf\_h2o()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.accf_h2o}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{accf\_h2o}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the aCCF of water vapour according to Yin et al. 2022 (aCCF\sphinxhyphen{}V1.0) and Matthes et al. 2022 (aCCF\sphinxhyphen{}V1.1): aCCF values are  given in average 
temperature response as over next 20 years, assuming pulse emission (P\sphinxhyphen{}ATR20\sphinxhyphen{}water\sphinxhyphen{}vapour {[}K/kg(fuel){]}). To calculate the aCCF of water vapour,
meteorological variable potential vorticity is required.
\begin{quote}\begin{description}
\sphinxlineitem{Returns accf}
\sphinxAtStartPar
Algorithmic climate change function of water vapour.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{accf\_ncontrail() (climaccf.accf.GeTaCCFs method)@\spxentry{accf\_ncontrail()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.accf_ncontrail}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{accf\_ncontrail}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the aCCF of night\sphinxhyphen{}time contrails according to Yin et al. 2022 (aCCF\sphinxhyphen{}V1.0) and Matthes et al. 2022 (aCCF\sphinxhyphen{}V1.1): aCCF values are  given in average 
temperature response as over next 20 years, assuming pulse emissions (P\sphinxhyphen{}ATR20\sphinxhyphen{}contrails {[}K/km{]}). To calculate the aCCF of night\sphinxhyphen{}time contrails,
meteorological variables temperature and relative humidity over ice are required. Notice that,
relative humidity over ice is required for the detemiation of presistent contrail formation areas.
\begin{quote}\begin{description}
\sphinxlineitem{Returns accf}
\sphinxAtStartPar
Algorithmic climate change function of nighttime contrails.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{accf\_o3() (climaccf.accf.GeTaCCFs method)@\spxentry{accf\_o3()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.accf_o3}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{accf\_o3}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the aCCF of ozone according to Yin et al. 2022 (aCCF\sphinxhyphen{}V1.0) and Matthes et al. 2022 (aCCF\sphinxhyphen{}V1.1): aCCF values are  given in 
average temperature response as over next 20 years, assuming pulse emission (P\sphinxhyphen{}ATR20\sphinxhyphen{}ozone {[}K/kg(NO2){]}). To calculate the aCCF of ozone, 
meteorological variables temperature and geopotential are required.
\begin{quote}\begin{description}
\sphinxlineitem{Returns accf}
\sphinxAtStartPar
Algorithmic climate change function of Ozone.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_accfs() (climaccf.accf.GeTaCCFs method)@\spxentry{get\_accfs()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.get_accfs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_accfs}}}{\emph{\DUrole{o}{**}\DUrole{n}{problem\_config}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates individual aCCFs, the merged aCCF and climate hotspots based on the defined configurations, parameters and etc.

\end{fulllineitems}

\index{get\_std() (climaccf.accf.GeTaCCFs method)@\spxentry{get\_std()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.get_std}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_std}}}{\emph{\DUrole{n}{var}}, \emph{\DUrole{n}{normalize}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the standard deviation of the inputted variables over the ensemble members.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{var}} \textendash{} variable.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{normalize}} \textendash{} If True, it calculates standard deviation over the normalized variable. If False, standard deviation is taken from the original variable.

\end{itemize}

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\sphinxlineitem{Returns x\_std}
\sphinxAtStartPar
standard deviation of the variable.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_xarray() (climaccf.accf.GeTaCCFs method)@\spxentry{get\_xarray()}\spxextra{climaccf.accf.GeTaCCFs method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.GeTaCCFs.get_xarray}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_xarray}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Creates an xarray dataset containing user\sphinxhyphen{}selected variables.
\begin{quote}\begin{description}
\sphinxlineitem{Returns ds}
\sphinxAtStartPar
xarray dataset containing user\sphinxhyphen{}selected variables (e.g., merged aCCFs, mean aCCFs, Climate hotspots).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dataset

\end{description}\end{quote}

\sphinxAtStartPar
:returns encoding
:rtype: dict

\end{fulllineitems}


\end{fulllineitems}

\phantomsection\label{\detokenize{modules:module-climaccf.accf}}\index{module@\spxentry{module}!climaccf.accf@\spxentry{climaccf.accf}}\index{climaccf.accf@\spxentry{climaccf.accf}!module@\spxentry{module}}\index{convert\_accf() (in module climaccf.accf)@\spxentry{convert\_accf()}\spxextra{in module climaccf.accf}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.convert_accf}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.accf.}}\sphinxbfcode{\sphinxupquote{convert\_accf}}}{\emph{\DUrole{n}{name}}, \emph{\DUrole{n}{value}}, \emph{\DUrole{n}{confg}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Converts aCCFs based on the selected configurations (i.e., efficacy, climate indicator, emission scenarios and time horizons).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{name}} \textendash{} Name of the species (e.g., ‘CH4’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{value}} \textendash{} Value of the species to be converted (P\sphinxhyphen{}ATR20 without efficacy factor).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{confg}} \textendash{} User\sphinxhyphen{}defined configurations for conversions.

\end{itemize}

\sphinxlineitem{Return type}
\sphinxAtStartPar
string

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\sphinxlineitem{Returns value}
\sphinxAtStartPar
Converted aCCF.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_Fin() (in module climaccf.accf)@\spxentry{get\_Fin()}\spxextra{in module climaccf.accf}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{modules:climaccf.accf.get_Fin}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{climaccf.accf.}}\sphinxbfcode{\sphinxupquote{get\_Fin}}}{\emph{\DUrole{n}{ds}}, \emph{\DUrole{n}{lat}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates TOA incoming solar radiation.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ds}} \textendash{} dataset to extract the number of day.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lat}} \textendash{} latitude.

\end{itemize}

\sphinxlineitem{Return type}
\sphinxAtStartPar
Dataset

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\sphinxlineitem{Returns Fin}
\sphinxAtStartPar
Incoming solar radiation.

\sphinxlineitem{Return type}
\sphinxAtStartPar
numpy.ndarray

\end{description}\end{quote}

\end{fulllineitems}



\chapter{An example}
\label{\detokenize{index:an-example}}
\sphinxAtStartPar
Here is an example how one can use sample data in test directory of CLIMaCCF to generate output for a set of user\sphinxhyphen{}defined configurations:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{climaccf}
\PYG{k+kn}{from} \PYG{n+nn}{climaccf}\PYG{n+nn}{.}\PYG{n+nn}{main\PYGZus{}processing} \PYG{k+kn}{import} \PYG{n}{ClimateImpact}

\PYG{n}{path\PYGZus{}here} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{climaccf/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{test\PYGZus{}path} \PYG{o}{=} \PYG{n}{path\PYGZus{}here} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/test/sample\PYGZus{}data/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{input\PYGZus{}dir} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path\PYGZus{}pl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{test\PYGZus{}path} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pressure\PYGZus{}lev\PYGZus{}june2018\PYGZus{}res0.5.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path\PYGZus{}sur}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{test\PYGZus{}path} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{surface\PYGZus{}june2018\PYGZus{}res0.5.nc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path\PYGZus{}lib}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{path\PYGZus{}here}\PYG{p}{\PYGZcb{}}
\PYG{n}{output\PYGZus{}dir} \PYG{o}{=} \PYG{n}{test\PYGZus{}path} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{env\PYGZus{}processed.nc}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} \PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{} CONFIGURATIONS \PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{} \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{confg} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} Configuration of the calculation of algorithmic climate change functions (aCCFs) \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{efficacy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{efficacy\PYGZhy{}option}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lee\PYGZus{}2021}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aCCF\PYGZhy{}V}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{V1.1}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aCCF\PYGZhy{}scalingF}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CH4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{H2O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Cont.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{CO2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{emission\PYGZus{}scenario}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{future\PYGZus{}scenario}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{climate\PYGZus{}indicator}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ATR}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TimeHorizon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PCFA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PCFA\PYGZhy{}ISSR}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ISSR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rhi\PYGZus{}threshold}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.9}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{temp\PYGZus{}threshold}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{235}\PYG{p}{\PYGZcb{}}
\PYG{n}{confg} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SAC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Q}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{43} \PYG{o}{*} \PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{eta}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{0.3}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{EI\PYGZus{}H2O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mf}{1.25}\PYG{p}{\PYGZcb{}}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} Technical specifiactions of aircraft/engine dependent parameters \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NOx\PYGZus{}EI\PYGZam{}F\PYGZus{}km}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TTV}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ac\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wide\PYGZhy{}body}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} Specifies the saved output file \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PMO}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NOx\PYGZus{}aCCF}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{unit\PYGZus{}K/kg(fuel)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{merged}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{True}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Chotspots}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MET\PYGZus{}variables}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} Output Options for Statistical analysis of Ensemble prediction system (EPS) data products \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}
\PYG{n}{confg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{std}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}

 \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} \PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{} MAIN \PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{}\PYGZpc{} \PYGZdq{}\PYGZdq{}\PYGZdq{}}

 \PYG{n}{CI} \PYG{o}{=} \PYG{n}{ClimateImpact}\PYG{p}{(}\PYG{n}{input\PYGZus{}dir}\PYG{p}{,} \PYG{n}{output\PYGZus{}dir}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{confg}\PYG{p}{)}
 \PYG{n}{CI}\PYG{o}{.}\PYG{n}{calculate\PYGZus{}accfs}\PYG{p}{(}\PYG{o}{*}\PYG{o}{*}\PYG{n}{confg}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The output netCDF file is generated in: \sphinxstyleemphasis{climaccf/test/sample\_data/env\_processed.nc}. In the following, a script is provided, enabling visualize the output.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{cartopy}\PYG{n+nn}{.}\PYG{n+nn}{mpl}\PYG{n+nn}{.}\PYG{n+nn}{geoaxes} \PYG{k+kn}{import} \PYG{n}{GeoAxes}
\PYG{k+kn}{import} \PYG{n+nn}{cartopy}\PYG{n+nn}{.}\PYG{n+nn}{crs} \PYG{k}{as} \PYG{n+nn}{ccrs}
\PYG{k+kn}{from} \PYG{n+nn}{cartopy}\PYG{n+nn}{.}\PYG{n+nn}{mpl}\PYG{n+nn}{.}\PYG{n+nn}{geoaxes} \PYG{k+kn}{import} \PYG{n}{GeoAxes}
\PYG{k+kn}{from} \PYG{n+nn}{cartopy}\PYG{n+nn}{.}\PYG{n+nn}{mpl}\PYG{n+nn}{.}\PYG{n+nn}{ticker} \PYG{k+kn}{import} \PYG{n}{LongitudeFormatter}\PYG{p}{,} \PYG{n}{LatitudeFormatter}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib} \PYG{k}{as} \PYG{n+nn}{mpl}
\PYG{k+kn}{from} \PYG{n+nn}{mpl\PYGZus{}toolkits}\PYG{n+nn}{.}\PYG{n+nn}{axes\PYGZus{}grid1} \PYG{k+kn}{import} \PYG{n}{AxesGrid}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{xarray} \PYG{k}{as} \PYG{n+nn}{xr}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{font}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{o}{*}\PYG{o}{*}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{family}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{serif}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{serif}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cmr10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{rc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{text}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{usetex}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{font} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{family}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}   \PYG{p}{:} \PYG{l+m+mi}{13}\PYG{p}{\PYGZcb{}}

\PYG{n}{path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{climaccf/test/sample\PYGZus{}data/env\PYGZus{}processed.nc}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{ds} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{open\PYGZus{}dataset}\PYG{p}{(}\PYG{n}{path}\PYG{p}{,} \PYG{n}{engine}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{h5netcdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{lats} \PYG{o}{=} \PYG{n}{ds}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{latitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{lons} \PYG{o}{=} \PYG{n}{ds}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{longitude}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}
\PYG{n}{lons1}\PYG{p}{,}\PYG{n}{lats1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{meshgrid}\PYG{p}{(}\PYG{n}{lons}\PYG{p}{,}\PYG{n}{lats}\PYG{p}{)}

\PYG{n}{cc\PYGZus{}lon} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flipud}\PYG{p}{(}\PYG{n}{lons1}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{cc\PYGZus{}lat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flipud}\PYG{p}{(}\PYG{n}{lats1}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{]}


\PYG{n}{time} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{datetime64}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2018\PYGZhy{}06\PYGZhy{}01T06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{pressure\PYGZus{}level} \PYG{o}{=} \PYG{l+m+mi}{250}
\PYG{n}{time\PYGZus{}idx} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where} \PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{time}\PYG{o}{.}\PYG{n}{values} \PYG{o}{==} \PYG{n}{time}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{pl\PYGZus{}idx}   \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{where} \PYG{p}{(}\PYG{n}{ds}\PYG{o}{.}\PYG{n}{level}\PYG{o}{.}\PYG{n}{values} \PYG{o}{==} \PYG{n}{pressure\PYGZus{}level}\PYG{p}{)} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{aCCF\PYGZus{}merged}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{flipud}\PYG{p}{(}\PYG{n}{ds}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aCCF\PYGZus{}merged}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{values}\PYG{p}{[}\PYG{n}{time\PYGZus{}idx}\PYG{p}{,} \PYG{n}{pl\PYGZus{}idx}\PYG{p}{,} \PYG{p}{:}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{p}{:}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{]}

\PYG{k}{def} \PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{projection} \PYG{o}{=} \PYG{n}{ccrs}\PYG{o}{.}\PYG{n}{PlateCarree}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{axes\PYGZus{}class} \PYG{o}{=} \PYG{p}{(}\PYG{n}{GeoAxes}\PYG{p}{,}
                \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{map\PYGZus{}projection}\PYG{o}{=}\PYG{n}{projection}\PYG{p}{)}\PYG{p}{)}


    \PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{axgr} \PYG{o}{=} \PYG{n}{AxesGrid}\PYG{p}{(}\PYG{n}{fig}\PYG{p}{,} \PYG{l+m+mi}{111}\PYG{p}{,} \PYG{n}{axes\PYGZus{}class}\PYG{o}{=}\PYG{n}{axes\PYGZus{}class}\PYG{p}{,}
                    \PYG{n}{nrows\PYGZus{}ncols}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}
                    \PYG{n}{axes\PYGZus{}pad}\PYG{o}{=}\PYG{l+m+mf}{1.0}\PYG{p}{,}
                    \PYG{n}{share\PYGZus{}all} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{,}
                    \PYG{n}{cbar\PYGZus{}location}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{n}{cbar\PYGZus{}mode}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{each}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{n}{cbar\PYGZus{}pad}\PYG{o}{=}\PYG{l+m+mf}{0.2}\PYG{p}{,}
                    \PYG{n}{cbar\PYGZus{}size}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{3}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{n}{label\PYGZus{}mode}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} note the empty label\PYGZus{}mode}

    \PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{ax} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{axgr}\PYG{p}{)}\PYG{p}{:}

        \PYG{n}{xticks} \PYG{o}{=} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+m+mi}{40}\PYG{p}{,} \PYG{l+m+mi}{55}\PYG{p}{]}
        \PYG{n}{yticks} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{,} \PYG{l+m+mi}{40}\PYG{p}{,}  \PYG{l+m+mi}{50}\PYG{p}{,}  \PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{70}\PYG{p}{,} \PYG{l+m+mi}{80}\PYG{p}{]}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{coastlines}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}xticks}\PYG{p}{(}\PYG{n}{xticks}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{projection}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}yticks}\PYG{p}{(}\PYG{n}{yticks}\PYG{p}{,} \PYG{n}{crs}\PYG{o}{=}\PYG{n}{projection}\PYG{p}{)}
        \PYG{n}{lon\PYGZus{}formatter} \PYG{o}{=} \PYG{n}{LongitudeFormatter}\PYG{p}{(}\PYG{n}{zero\PYGZus{}direction\PYGZus{}label}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{n}{lat\PYGZus{}formatter} \PYG{o}{=} \PYG{n}{LatitudeFormatter}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{xaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{lon\PYGZus{}formatter}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{lat\PYGZus{}formatter}\PYG{p}{)}
        \PYG{n}{ax}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{n}{time}\PYG{p}{)}
        \PYG{n}{p} \PYG{o}{=} \PYG{n}{ax}\PYG{o}{.}\PYG{n}{contourf}\PYG{p}{(}\PYG{n}{cc\PYGZus{}lon}\PYG{p}{,} \PYG{n}{cc\PYGZus{}lat}\PYG{p}{,} \PYG{n}{aCCF\PYGZus{}merged}\PYG{p}{,}
                        \PYG{n}{transform}\PYG{o}{=}\PYG{n}{projection}\PYG{p}{,}
                        \PYG{n}{cmap}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YlOrRd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

        \PYG{n}{axgr}\PYG{o}{.}\PYG{n}{cbar\PYGZus{}axes}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{colorbar}\PYG{p}{(}\PYG{n}{p}\PYG{p}{)}
        \PYG{n}{cax} \PYG{o}{=} \PYG{n}{axgr}\PYG{o}{.}\PYG{n}{cbar\PYGZus{}axes}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{axis} \PYG{o}{=} \PYG{n}{cax}\PYG{o}{.}\PYG{n}{axis}\PYG{p}{[}\PYG{n}{cax}\PYG{o}{.}\PYG{n}{orientation}\PYG{p}{]}
        \PYG{n}{axis}\PYG{o}{.}\PYG{n}{label}\PYG{o}{.}\PYG{n}{set\PYGZus{}text}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{aCCF\PYGZhy{}merged [K/kg(fuel)]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
For instance, using the script, one should get the following figure for the merged aCCF at 250hPa for 2018\sphinxhyphen{}06\sphinxhyphen{}01T06:

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=500\sphinxpxdimen]{{merged_250}.png}\hspace*{\fill}}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\section{Acknowledmgements}
\label{\detokenize{index:acknowledmgements}}
\noindent{\hspace*{\fill}\sphinxincludegraphics[width=100\sphinxpxdimen]{{Alarm_LOGO}.eps}\hspace*{\fill}}

\sphinxAtStartPar
\sphinxstyleemphasis{This library has been developed within ALARM and FLyATM4E Projects. FLyATM4E has received funding from the SESAR Joint Undertaking under the European Union’s Horizon 2020 research and innovation programme under grant agreement No 891317. The JU receives support from the European Union’s Horizon 2020 research and innovation programme and the SESAR JU members other than the Union.
ALARM has received funding from the SESAR Joint Undertaking (JU) under grant agreement No 891467. The JU receives support from the European Union’s Horizon 2020 research and innovation programme and the SESAR JU members other than the Union.}.
\begin{quote}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline

\sphinxAtStartPar
\sphinxincludegraphics[width=50\sphinxpxdimen]{{european-union_flag_yellow_high}.jpg}
&
\sphinxAtStartPar
\sphinxincludegraphics[width=50\sphinxpxdimen]{{sesar}.png}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}
\end{quote}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{c}
\item\relax\sphinxstyleindexentry{climaccf.accf}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.accf}}
\item\relax\sphinxstyleindexentry{climaccf.calc\_altrv\_vars}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.calc_altrv_vars}}
\item\relax\sphinxstyleindexentry{climaccf.contrail}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.contrail}}
\item\relax\sphinxstyleindexentry{climaccf.extend\_dim}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.extend_dim}}
\item\relax\sphinxstyleindexentry{climaccf.extract\_data}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.extract_data}}
\item\relax\sphinxstyleindexentry{climaccf.processing\_surf\_vars}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.processing_surf_vars}}
\item\relax\sphinxstyleindexentry{climaccf.weather\_store}\sphinxstyleindexpageref{modules:\detokenize{module-climaccf.weather_store}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}