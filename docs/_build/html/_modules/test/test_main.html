
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>test.test_main &#8212; envlib V0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for test.test_main</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">envlib</span>
<span class="kn">from</span> <span class="nn">envlib.main_processing</span> <span class="kn">import</span> <span class="n">ClimateImpact</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>

<div class="viewcode-block" id="test_main"><a class="viewcode-back" href="../../test.html#test.test_main.test_main">[docs]</a><span class="k">def</span> <span class="nf">test_main</span><span class="p">():</span>

    <span class="sd">&quot;&quot;&quot; %%%%%%%%%%%% DIRECTORIES %%%%%%%%%%%% &quot;&quot;&quot;</span>

    <span class="n">path_here</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
    <span class="n">test_path</span> <span class="o">=</span> <span class="n">path_here</span> <span class="o">+</span> <span class="s1">&#39;/sample_data/&#39;</span>
    <span class="n">lib_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/envlib/&#39;</span>
    <span class="n">path_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;path_pl&#39;</span><span class="p">:</span> <span class="n">test_path</span> <span class="o">+</span> <span class="s1">&#39;pressure_lev_june2018_res0.5.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;path_sur&#39;</span><span class="p">:</span> <span class="n">test_path</span> <span class="o">+</span> <span class="s1">&#39;surface_june2018_res0.5.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;path_lib&#39;</span><span class="p">:</span> <span class="n">lib_path</span><span class="p">}</span>
    <span class="n">path_save</span> <span class="o">=</span> <span class="n">test_path</span> <span class="o">+</span> <span class="s1">&#39;env_processed.nc&#39;</span>
    
    <span class="sd">&quot;&quot;&quot; %%%%%%%%%% CONFIGURATIONS %%%%%%%%%% &quot;&quot;&quot;</span>

    <span class="n">confg</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="sd">&quot;&quot;&quot; Climate Metric Selection&quot;&quot;&quot;</span>
    
    <span class="c1"># If true, it includes efficacies</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;efficacy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                         <span class="c1"># Options: True, False</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;efficacy-option&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lee et al. (2021)&#39;</span>   <span class="c1"># Options: &#39;A&#39;: includes efficacies according to Lee et al. (2021), </span>
                                                    <span class="c1">#          &#39;B&#39;: user-defined efficacies ({&#39;CH4&#39;: xx, &#39;O3&#39;: xx, &#39;H2O&#39;: xx, &#39;Cont.&#39;: xx, &#39;CO2&#39;: xx})</span>

    <span class="c1"># Specifies the version of aCCF</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;aCCF-V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Matthes et al. (2022)&#39;</span>            <span class="c1"># Options: Yin et al. (2022), &#39;Matthes et al. (2022)&#39;</span>

    <span class="c1"># User-defined scaling factors for aCCFs</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;aCCF-scalingF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CH4&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Cont.&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;CO2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

    <span class="c1"># Specifies the emission scenario of the climate metric. Currently, pulse and business-as-usual (BAU) future emission scenarios have been implemented</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;emission_scenario&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;future_scenario&#39;</span>       <span class="c1"># Options: pulse, future_scenario</span>

    <span class="c1"># Specifies the climate indicator. Currently, Average Temperature Response (ATR) has been implemented</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;climate_indicator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ATR&#39;</span>         <span class="c1"># Options: ATR</span>

    <span class="c1"># Specifies the time horizon (in years) over which the selected climate indicator is calculated</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;TimeHorizon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>                  <span class="c1"># Options: 20, 50, 100 </span>

    <span class="c1"># Specifies the threshold of relative humidity over ice in order to identify ice supersaturated regions. Note that this threshold depends on the resolution of the input data (for more details see Dietmueller et al. 2022)</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;rhi_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.90</span>               <span class="c1"># Options: user defined threshold value &lt; 1. Threshold depends on the used data set, e.g., in case of the reanalysis data product ERA5 with high resolution realisation it is 0.9</span>


    <span class="sd">&quot;&quot;&quot; Technical Specifiactions of Aircraft dependent Emission Parameters&quot;&quot;&quot;</span>
    
    <span class="c1"># Specifies NOx Emission Index (NOx_EI) and flown distance per kg burnt fuel (F_km) </span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;NOx_EI&amp;F_km&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TTV&#39;</span> <span class="c1"># Options: &#39;TTV&#39; for typical transantlantic fleet mean values from literature and  &#39;ac_dependent&#39; for altitude and aircraft/engine dependent values</span>
                                     <span class="c1"># Note that &quot;If Confg[&#39;NOx_EI&amp;F_km&#39;] = &#39;TTV&#39;, the following confg[&#39;ac_type&#39;] is ignored.&quot;</span>

    <span class="c1"># If Confg[&#39;NOx_EI&amp;F_km&#39;] = &#39;ac_dependent&#39;, aggregated aircraft type needs to be selected. Note that these values take into account the altitude dependence of NOx_EI and F_km (for more details see Dietmueller et al. 2022)</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;ac_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;wide-body&#39;</span>              <span class="c1"># Options: &#39;regional&#39;, &#39;single-aisle&#39;, &#39;wide-body&#39;</span>


    <span class="c1"># weather-dependent coefficients for calculating NOx emission index using Boeing Fuel Flow Method 2 (BFFM2)</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;Coef.BFFM2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                  <span class="c1"># Options: True, False</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;method_BFFM2_SH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SH&#39;</span>
    

    <span class="sd">&quot;&quot;&quot;Output Options&quot;&quot;&quot;</span>
    
    <span class="c1"># If true, the primary mode ozone (PMO) effect is included to the CH4 aCCF and the total NOx aCCF</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;PMO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                         <span class="c1"># Options: True, False</span>

    <span class="c1"># If true, the total NOx aCCF is calculated (i.e. aCCF-NOx = aCCF-CH4 + aCCF-O3)</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;NOx_aCCF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                        <span class="c1"># Options: True, False</span>
    
    <span class="c1"># If true, all individual aCCFs are converted to K/kg(fuel) and outputted in this unit.</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;unit_K/kg(fuel)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>            <span class="c1"># Options: True, False</span>

    <span class="c1"># If true, merged non-CO2 aCCF is calculated</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;merged&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                     <span class="c1"># Options: True, False</span>

    <span class="c1"># If true, climate hotspots, that define regions which are very senitive to aviation emissisions, are calculated (for more details see Dietmueller et al. 2022)</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;Chotspots&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                  <span class="c1"># Options: True, False</span>
    <span class="c1"># If true, it assigns binary values to climate hotspots (i.e., 0 for areas with climate impacts below the specified </span>
    <span class="c1"># threshold, and 1 for areas with higher climate impacts than the threshold)</span>
    <span class="c1"># If false, it assigns 0 for areas with climate impacts below the specified threshold and gives actual values for those</span>
    <span class="c1"># areas with higher climate impacts than the threshold.</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;hotspots_binary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>             <span class="c1"># Options: True, False</span>
    <span class="c1"># Determines dynamically the threshold for identifying climate hotspots by calculating the e.g., 99th percentile term of the of</span>
    <span class="c1"># the normal distribution of the respective merged aCCF</span>
    <span class="c1"># The percentiles are also outputted in netCDF output file</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;hotspots_percentile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>          <span class="c1"># Options: percentage &lt; 100     </span>

    <span class="c1"># If true, all meteorological input variables are saved in the netCDF output file in same resolution as aCCFs</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;MET_variables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>             <span class="c1"># Options: True, False</span>

    <span class="c1"># If true, polygons containing climate hotspots will be saved in the GeoJson file</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;geojson&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                   <span class="c1"># Options: True, False</span>

    <span class="c1"># Specifies the color of polygons</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;copper&#39;</span>                  <span class="c1"># Options: colors of cmap, e.g., copper, jet, Reds</span>
    
    <span class="sd">&quot;&quot;&quot; Output Options for Statistical analysis of Ensemble prediction system (EPS) data products &quot;&quot;&quot;</span>
    <span class="c1"># The following two options (confg[&#39;mean&#39;], confg[&#39;std&#39;]) are ignored if the input data are deterministic</span>

    <span class="c1"># If true, mean values of aCCFs and variables are saved in the netCDF output file</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                      <span class="c1"># Options: True, False</span>

    <span class="c1"># If true, standard deviation of aCCFs and variables are saved in the netCDF output file</span>
    <span class="n">confg</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                       <span class="c1"># Options: True, False</span>



    <span class="sd">&quot;&quot;&quot; %%%%%%%%%%%%%%%%% MAIN %%%%%%%%%%%%%%%% &quot;&quot;&quot;</span>
    <span class="c1"># Specification of output in terms of resolution and covered geographical area</span>

    <span class="n">CI</span> <span class="o">=</span> <span class="n">ClimateImpact</span><span class="p">(</span><span class="n">path_</span><span class="p">,</span> <span class="n">horizontal_resolution</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lat_bound</span><span class="o">=</span><span class="p">(</span><span class="mf">33.5</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">),</span> <span class="n">lon_bound</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">26.5</span><span class="p">,</span> <span class="mf">45.5</span><span class="p">),</span>
                                          <span class="n">save_path</span><span class="o">=</span><span class="n">path_save</span><span class="p">)</span>
    <span class="n">CI</span><span class="o">.</span><span class="n">calculate_accfs</span><span class="p">(</span><span class="o">**</span><span class="n">confg</span><span class="p">)</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">envlib</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=abolfazlsimorgh&repo=envlib&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gStarted.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gStarted.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gStarted.html#input">Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gStarted.html#running-output">Running &amp; Output</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Processing of meteorological input data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html#module-envlib.calc_altrv_vars">Calculation of meteorological input data from alternative variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html#weather-store">Weather Store</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html#module-envlib.contrail">Persistent Contrail Formation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html#calculation-of-prototype-accfs">Calculation of prototype aCCFs</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Abolfazl Simorgh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>