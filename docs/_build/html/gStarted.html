
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation &#8212; envlib V0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Processing" href="modules.html" />
    <link rel="prev" title="EnVironmental LiBrary (EnVLiB)" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>The installation is the first step to working with EnVLiB. In the following, the steps required to install the library are provided (Some parts need to be modified,
for instance, I need to check the current envlib is compatible with which versions of pythons, and also, for release, we may decide to publish it under
PyPi, so downloading or cloning the library is not the only option).</p>
<ol class="arabic simple" start="0">
<li><p>it is highly recomended to create a virtual environment with Python version 3.8:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">name_env</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.8</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">name_env</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Clone or download the repository.</p></li>
<li><p>Locate yourself in the envlib (library folder) path, and run the following line, using terminal (in MacOS and Linux) or cmd (Windows), which will install all dependencies:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>There is sample data and a test script in the package. To run it, at the library folder, enter the following command:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">pytest</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>The library runs successfully if env_processed.nc is generated at the library folder/test/sample_data/. One can visualize the file using a visualization tool (e.g., ferret, NCO, Panoply, etc.).</p></li>
</ol>
</div>
<div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>The scope of EnVLiB is to provide individual and merged aCCFs as spatially and temporally resolved information considering meteorology from the actual synoptical situation, the engine/aircraft type, the selected physical climate metric, and the selected version of prototype algorithms in individual aCCFs. Consequently, some user-preferred settings need to
be defined. Within EnVLib, theses settings are defined in a dictionary, called <em>confg</em> (i.e., confg [‘name’] = value). Notice that default
configurations have been defined within the library; thus, defining dictionary <em>confg</em> is optional. Information on the settings, options, and default values is provided in the following.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">confg</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># If true, it includes efficacies according to Lee et al. (2021)</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;efficacy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                  <span class="c1"># Options: True, False (default: False)</span>

<span class="c1"># Specifies the emission scenario. Currently, pulse and future emission scenarios have been implemented</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;emission_scenario&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;future_scenario&#39;</span>       <span class="c1"># Options: pulse, future_scenario (default: pulse)</span>

<span class="c1"># Specifies the climate indicator. Currently, Average Temperature Response has been implemented</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;climate_indicator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ATR&#39;</span>         <span class="c1"># Options: ATR</span>

<span class="c1"># Specifies the time horizon (in years) over which the metric is calculated</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;TimeHorizon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>                  <span class="c1"># Options: 20, 50, 100 (default: 20)</span>

<span class="c1"># Specifies the threshold of relative humidity over ice in order to identify ice supersaturated regions. Note that this threshold</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;rhi_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.90</span>               <span class="c1"># Options: depends on the resolution of the input data (see SEction XX Dietmüller et al. 2021)</span>
                                            <span class="c1"># e.g., in case of ERA5_HRES it is 0.9</span>

<span class="sd">&quot;&quot;&quot;Output Options&quot;&quot;&quot;</span>

<span class="c1"># If true, all individual aCCFs converted to K/kg(fuel)</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;unit_K/kg(fuel)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>            <span class="c1"># Options: True, False (default: False)</span>

<span class="c1"># If true,  PMO effect included to CH4 aCCF and total NOx aCCF</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;PMO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                         <span class="c1"># Options: True, False (default: False)</span>

<span class="c1"># If true, merged aCCF is calculated</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;merged&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                     <span class="c1"># Options: True, False  (default: True)</span>

<span class="c1"># NOx and inverse EIs</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;NOx&amp;inverse_EIs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TTV&#39;</span>   <span class="c1"># Options: &#39;TTV (typical transantlantic fleet mean values)&#39;, &#39;ac_dependent&#39; (default: TTV)</span>
                                   <span class="c1"># Note that &quot;If Confg[&#39;NOx&amp;inverse_Eis&#39;] = &#39;TTV&#39;, the following confg[&#39;ac_type&#39;] is ignored.&quot;</span>

<span class="c1"># If Confg[&#39;NOx&amp;inverse_EIs&#39;] = &#39;ac_dependent&#39;, aircraft type needs to be selected</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;ac_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;wide-body&#39;</span>              <span class="c1"># Options: &#39;regional&#39;, &#39;single-aisle&#39;, &#39;wide-body&#39; (default: &#39;wide-body&#39;)</span>

<span class="c1"># If true, NOx aCCF is calculated (i.e. aCCF-NOx = aCCF-CH4 + aCCF-O3)</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;NOx_aCCF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                   <span class="c1"># Options: True, False (default: True)</span>

<span class="sd">&quot;&quot;&quot;Climate Hotspots&quot;&quot;&quot;</span>

<span class="c1"># If true, climate hotspots are calculated&#39;</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;Chotspots&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                  <span class="c1"># Options: True, False (default: True)</span>

<span class="c1"># If true, it assigns binary values to climate hotspots (i.e., 0 for areas with climate impacts below the specified threshold, and 1 for areas with higher climate impacts than the threshold)</span>
<span class="c1"># If false, it assigns 0 for areas with climate impacts below the specified threshold and gives actual values for those areas with higher climate impacts than the threshold.</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;hotspots_binary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>             <span class="c1"># Options: True, False (default: True)</span>

<span class="c1"># Determines dynamically the threshold for identifying climate hotspots by calculating the e.g., 99th percentile term of the of the normal distribution of the respective merged aCCF The percentiles are also outputted in netCDF output file</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;hotspots_percentile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>          <span class="c1"># Options: percentage &lt; 100 (default: 99)</span>

<span class="sd">&quot;&quot;&quot; Statistical analysis of EPS forecast &quot;&quot;&quot;</span>
<span class="c1"># The following two options (confg[&#39;mean&#39;], confg[&#39;std&#39;]) are ignored if the input data are deterministic</span>

<span class="c1"># If true, mean values of aCCFs and variables are saved in the netCDF output file</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                      <span class="c1"># Options: True, False (default: True)</span>
<span class="c1"># If true, standard deviation of aCCFs and variables are saved in the netCDF output file</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                       <span class="c1"># Options: True, False (default: True)</span>

<span class="sd">&quot;&quot;&quot; Output &quot;&quot;&quot;</span>

<span class="c1"># If true, all meteorological input variables are saved in the netCDF output file in same resolution as aCCFs</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;MET_variables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>             <span class="c1"># Options: True, False (default: False)</span>

<span class="c1"># If true, polygons containing climate hotspots will be saved in the GeoJson file</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;geojson&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>                   <span class="c1"># Options: True, False (default: False)</span>

<span class="c1"># Specifies the color of polygons</span>
<span class="n">confg</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;copper&#39;</span>                  <span class="c1"># Options: colors of cmap, e.g., copper, jet, Reds (default: &#39;copper&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="input">
<h1>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h1>
<p>To calculate aCCFs, some meteorological variables are required. EnVLib takes these variables as input (See Table 5 of the connected paper (i.e., Dietmüller et al. (2021))).
These variables are: Temperature, Geopotential, Relative humidity, and Potential vorticity unit at different pressure levels,
and outgoing longwave radiation (or top net thermal radiation) at the top of the atmosphere.
The current implementation of the Library is compatible with the standard of the European Centre for Medium-Range Weather Forecasts (ECMWF) data.
Since the pressure level and surface variables are typically provided within different datasets, users should provide different datasets.
Within EnVLiB, the directories of these two datasets are to be defined in a dictionary as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_dir</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">input_dir</span><span class="p">[</span><span class="s1">&#39;path_pl&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dir_pressure_variables</span>  <span class="c1"># Directory for input data provided in pressure levels such as temperature, geopotentialand relative humidity</span>
<span class="n">input_dir</span><span class="p">[</span><span class="s1">&#39;path_sur&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">dir_surface_variables</span>  <span class="c1"># Directory for input data provided in single pressure level such as top net thermal radiation at the the TOA</span>
</pre></div>
</div>
<p>In addition to the directories for input data, directory of the EnvLib needs to be specified within input_dir:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_dir</span> <span class="p">[</span><span class="s1">&#39;path_lib&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnVLiB_dir</span>      <span class="c1"># Directory of EnVLiB</span>
</pre></div>
</div>
<p>Finally, destination directory where all output will be written is to be inputted by user:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">dir_results</span>    <span class="c1"># Destination directory where all output will be written</span>
</pre></div>
</div>
</div>
<div class="section" id="running">
<h1>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h1>
<p>After defining configurations and inputting required directories, EnVLiB is ready to generate outputs. First of all, we import library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">envlib</span>
<span class="kn">from</span> <span class="nn">envlib.main_processing</span> <span class="kn">import</span> <span class="n">ClimateImpact</span>
</pre></div>
</div>
<p>Then, the inputted variables will be processed by using the following function. The processing in this step is mainly related to extracting variables within inputted data, calculating required variables from alternative ones in case of missing some variables (see Table 5 of the connected paper), unifying the naming and dimension of variables, and changing the resolution and geographical area.
The preferred horizontal resolution and geographical area are inputted to the function. Notice that the horizontal resolution cannot be increased.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CI</span> <span class="o">=</span> <span class="n">ClimateImpact</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">horizontal_resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span> <span class="n">lat_bound</span><span class="o">=</span><span class="p">(</span><span class="n">lat_min</span><span class="p">,</span> <span class="n">lat_max</span><span class="p">),</span> <span class="n">lon_bound</span><span class="o">=</span><span class="p">(</span><span class="n">lon_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">),</span> <span class="n">save_path</span><span class="o">=</span><span class="n">output_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>After processing the weather data, aCCFs are calculated using the following command with respect to the defined settings in the dictionary (i.e., confg) and saved within the netCDF file format in the specified directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CI</span><span class="o">.</span><span class="n">calculate_accfs</span><span class="p">(</span><span class="o">**</span><span class="n">confg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="output">
<h1>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h1>
<p>Following the previous steps, an output file (in netCDF format) will be generated. The output file contains different variables depending on the selected configurations (in <em>confg</em>).
For instance, this file can contain both aCCFs and meteorological variables (if confg [‘MET_variables’] = true). The generated netCDF file is compatible with well-known visualization tools such as ferret, NCO, and Panoply.
In addition to the netCDF file, if one selects: confg[‘geojson’] = True, confg[Chotspots] = True, some GeoJson files (number of pressure levels * number of time) will be generated in the specified output file.</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">envlib</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=abolfazlsimorgh&repo=envlib&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="#running">Running</a></li>
<li class="toctree-l1"><a class="reference internal" href="#output">Output</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#module-envlib.calc_altrv_vars">Calculation of Alternative Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#weather-store">Weather Store</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#module-envlib.contrail">Persistent Contrails Formation</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#calculation-of-accfs">Calculation of aCCFs</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">EnVironmental LiBrary (EnVLiB)</a></li>
      <li>Next: <a href="modules.html" title="next chapter">Data Processing</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Abolfazl Simorgh.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/gStarted.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>